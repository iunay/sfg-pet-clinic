version: 2
jobs:
  build:
    docker:
        - image: circleci/openjdk:11-jdk

    working_directory: ~/repo
    environment:
          MAVEN_OPTS: -Xmx3200m
    steps:
        - checkout

        - restore_cache: #download and cache dependencies
            key: v1-dependencies-{{ checksum "pom.xml" }}
    -run:
        mvn install -DskipTests
        mvn depencendency:go-offline
    -save_cache:
              paths:
                - ~/.m2
              key: maven-{{ checksum "pom.xml" }}
              -run: mvn integration-test 